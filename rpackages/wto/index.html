<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.77.0"><title>wTO | Personal wonderland of Deisy Gysi</title><meta property="twitter:site" content="@GysiDeisy"><meta property="twitter:creator" content="@GysiDeisy"><meta name=description content="Computing Weighted Topological Overlaps (wTO) & Consensus wTO Network"><meta property="og:site_name" content="Personal wonderland of Deisy Gysi"><meta property="og:title" content="wTO | Personal wonderland of Deisy Gysi"><meta property="og:description" content="Computing Weighted Topological Overlaps (wTO) & Consensus wTO Network"><meta property="og:type" content="page"><meta property="og:url" content="/rpackages/wto/"><meta property="og:locale" content="en"><meta property="og:image" content="/rpackages/wto/hex-featured.jpg"><meta property="twitter:card" content="summary"><meta name=twitter:image content="/rpackages/wto/hex-featured.jpg"><meta itemprop=name content="wTO"><meta itemprop=description content="wTO: Computing Weighted Topological Overlaps (wTO) & Consensus wTO Network Computes the Weighted Topological Overlap with positive and negative signs (wTO) networks (Nowick et al. (2009) doi:10.1073/pnas.0911376106) given a data frame containing the mRNA count/ expression/ abundance per sample, and a vector containing the interested nodes of interaction (a subset of the elements of the full data frame).
It also computes the cut-off threshold or p-value based on the individuals bootstrap or the values reshuffle per individual (Gysi et al."><meta itemprop=datePublished content="2018-11-17T00:00:00+00:00"><meta itemprop=dateModified content="2018-11-17T00:00:00+00:00"><meta itemprop=wordCount content="3778"><meta itemprop=image content="/rpackages/wto/hex-featured.jpg"><meta itemprop=keywords content><!--[if IE]><script src=//html5shiv.googlecode.com/svn/trunk/html5.js></script><![endif]--><link rel="shortcut icon" href=/img/logo_color.png type=image/x-icon><link rel=icon href=/img/logo_color.png type=image/x-icon><link rel=stylesheet href=/style.main.min.577d2f8d4465df5b2a2e293853c260f0bb87ddd371eb9614396cc5fb8019cfb5.css integrity="sha256-V30vjURl31sqLik4U8Jg8LuH3dNx65YUOWzF+4AZz7U=" media=screen><script src=/panelset.min.41f62c42d5f25dd80e81136866f4f1baa1bc17669edfd002e75c0e107953789b.js type=text/javascript></script><script src=/main.min.b8a5fd21f719c4fffa69ddf09c6f7625c216ca05351d310407c179853bd1ef00.js type=text/javascript></script><div class=js-toggle-wrapper><div class=js-toggle><div class=js-toggle-track><div class=js-toggle-track-check><img src="data:image/png;base64,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" role=presentation style=pointer-events:none width=16 height=16></div><div class=js-toggle-track-x><img src="data:image/png;base64,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" role=presentation style=pointer-events:none width=16 height=16></div></div><div class=js-toggle-thumb></div><input class=js-toggle-screenreader-only type=checkbox aria-label="Switch between Dark and Light mode"></div></div><style>.js-toggle-wrapper{display:table;margin:0 auto}.js-toggle{touch-action:pan-x;display:inline-block;position:relative;cursor:pointer;background-color:transparent;border:0;padding:0;-webkit-touch-callout:none;user-select:none;-webkit-tap-highlight-color:transparent;-webkit-tap-highlight-color:transparent}.js-toggle-screenreader-only{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.js-toggle-track{width:50px;height:24px;padding:0;border-radius:30px;background-color:#0f1114;transition:all .2s ease}.js-toggle-track-check{position:absolute;width:17px;height:17px;left:5px;top:0;bottom:0;margin-top:auto;margin-bottom:auto;line-height:0;opacity:0;transition:opacity .25s ease}.js-toggle--checked .js-toggle-track-check{opacity:1;transition:opacity .25s ease}.js-toggle-track-x{position:absolute;width:17px;height:17px;right:5px;top:0;bottom:0;margin-top:auto;margin-bottom:auto;line-height:0;opacity:1;transition:opacity .25s ease}.js-toggle--checked .js-toggle-track-x{opacity:0}.js-toggle-thumb{position:absolute;top:1px;left:1px;width:22px;height:22px;border-radius:50%;background-color:#fafafa;box-sizing:border-box;transition:all .5s cubic-bezier(0.23,1,0.32,1)0ms;transform:translateX(0)}.js-toggle--checked .js-toggle-thumb{transform:translateX(26px);border-color:#19ab27}.js-toggle--focus .js-toggle-thumb{box-shadow:0 0 2px 3px #ffa7c4}.js-toggle:active .js-toggle-thumb{box-shadow:0 0 5px 5px #ffa7c4}</style><script>var body=document.body;var switcher=document.getElementsByClassName('js-toggle')[0];switcher.addEventListener("click",function(){this.classList.toggle('js-toggle--checked');this.classList.add('js-toggle--focus');if(this.classList.contains('js-toggle--checked')){body.classList.add('dark-mode');localStorage.setItem('darkMode','true');}else{body.classList.remove('dark-mode');setTimeout(function(){localStorage.removeItem('darkMode');},100);}})
if(localStorage.getItem('darkMode')){switcher.classList.add('js-toggle--checked');body.classList.add('dark-mode');}</script></head><body><div class="grid-container single"><header class="site-header pt4 pb2 mb4 bb b--transparent ph5 headroom z-max" role=banner><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],processEscapes:true,processEnvironments:true},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}};window.addEventListener('load',(event)=>{document.querySelectorAll("mjx-container").forEach(function(x){x.parentElement.classList+='has-jax'})});</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><nav class="site-nav db dt-l w-100" role=navigation><a class="site-brand db dtc-l v-mid link no-underline w-100 w-33-l tc tl-l" href=/ title=Home><img src=/img/logo_color.png class="dib db-l h2 w-auto" alt="Personal wonderland of Deisy Gysi"></a><div class="site-links db dtc-l v-mid w-100 w-47-l tc tr-l mt3 mt0-l ttu tracked"><a class="link f6 f5-l dib pv1 ph2" href=/about/ title="About me">About</a>
<a class="link f6 f5-l dib pv1 ph2" href=/projects/ title=Projects>Projects</a>
<a class="link f6 f5-l dib pv1 ph2" href=/publications/ title=Publications>Publications</a>
<a class="link f6 f5-l dib pv1 ph2" href=/talk/ title=Talks>Talks</a>
<a class="link f6 f5-l dib pv1 ph2" href=/teaching/ title=Teaching>Teaching</a>
<a class="link f6 f5-l dib pv1 ph2 active" href=/rpackages/ title="R Packages">R Packages</a>
<a class="link f6 f5-l dib pv1 ph2" href=/cv/ title=CV>CV</a>
<a class="link f6 f5-l dib pv1 ph2" href=/links/ title="Useful Links">Useful Links</a></div></nav></header><main class="page-main pa4" role=main><section class="page-content mw7 center"><article class="post-content pa0 ph4-l"><header class=post-header><h1 class="f1 lh-solid measure-narrow mb3 fw4">wTO</h1><h4 class="f4 mt0 mb4 lh-title measure">Computing Weighted Topological Overlaps (wTO) & Consensus wTO Network</h4><p class="f6 measure lh-copy mv1">By Deisy Morselli Gysi in <a href=/categories/r-packages>r packages</a> <a href=/categories/co-expression>co-expression</a> <a href=/categories/networks>networks</a></p><p class="f7 db mv0 ttu">November 17, 2018</p><div class="ph0 pt5"><a class="btn-links mr2 ba dib" href=https://cran.r-project.org/web/packages/wTO/ target=_blank rel=noopener><i class="fas fa-box-open fa-lg fa-fw mr2"></i>package</a></div></header><section class="post-body pt5 pb4"><script src=/rpackages/wto/index_files/header-attrs/header-attrs.js></script><div id=wto-computing-weighted-topological-overlaps-wto-consensus-wto-network class="section level2"><h2>wTO: Computing Weighted Topological Overlaps (wTO) & Consensus wTO Network</h2><p>Computes the Weighted Topological Overlap with positive and negative signs (wTO) networks (Nowick et al. (2009) <a href=doi:10.1073/pnas.0911376106 class=uri>doi:10.1073/pnas.0911376106</a>) given a data frame containing the mRNA count/ expression/ abundance per sample, and a vector containing the interested nodes of interaction (a subset of the elements of the full data frame).</p><p>It also computes the cut-off threshold or p-value based on the individuals bootstrap or the values reshuffle per individual (Gysi et al. 2017 <a href=https://doi.org/10.1186/s12859-018-2351-7 class=uri>https://doi.org/10.1186/s12859-018-2351-7</a>). It also allows the construction of a <strong>consensus network</strong>, based on multiple wTO networks. The package includes a visualization tool for the networks.</p><p>You can download the package from CRAN using:</p><p><code>install.packages('wTO')</code></p><div id=input-data class="section level3"><h3>Input data</h3><p>The <code>wTO</code> package, can be used on any kind of count data, but we highly
recommend to use normalized and quality controlled data according to the
data type such as RMA, MD5 for microarray, RPKM, TPM or PKM for RNA-seq,
sample normalized data for metagenomics.</p><p>As an example, the package contains three data sets, two from microarray
chips (<code>Microarray_Expression1</code> and <code>Microarray_Expression2</code>), and one
from abundance in metagenomics (<code>metagenomics_abundance</code>).</p></div><div id=wto class="section level3"><h3>wTO</h3><p>The wTO method is a method for building networks based on pairwise
correlations normalized and corrected by all shared correlations. For
this reason, the user can choose a set of factors of interest, called
here <em>Overlaps</em>, those are the nodes that will be corrected and
normalized by all other factors in the dataset. Those factors can be
Transcription Factor, long non coding RNAs, a set of species of interest
etc.</p></div><div id=genomic-data class="section level3"><h3>Genomic data</h3><p>The <code>wTO</code> package contains 2 data sets that were obtained using
expression arrays (<code>Microarray_Expression1</code> and
<code>Microarray_Expression2</code>), they were previously normalized and the
quality control was done. We will use it to build the wTO network using
the different methods implemented in the package.</p><p>First we are going to inspect those data sets.</p><pre class=r><code>require(wTO)</code></pre><pre><code>## Loading required package: wTO</code></pre><pre class=r><code>require(magrittr)</code></pre><pre><code>## Loading required package: magrittr</code></pre><pre class=r><code>data(&quot;ExampleGRF&quot;)
data(&quot;Microarray_Expression1&quot;)
data(&quot;Microarray_Expression2&quot;)

dim(Microarray_Expression1)</code></pre><pre><code>## [1] 268  18</code></pre><pre class=r><code>dim(Microarray_Expression2)</code></pre><pre><code>## [1] 268  18</code></pre><pre class=r><code>Microarray_Expression1[1:5,1:5]</code></pre><pre><code>##               ID1      ID2      ID3      ID4      ID5
## FAM122B  5.325653 5.039814 5.099828 5.053185 5.213816
## DEFB108B 2.038747 1.965599 1.925807 1.977435 2.079381
## CCSER2   4.973347 4.865783 4.818910 5.024392 4.697314
## GPD2     5.453287 5.595471 5.223886 5.130226 5.370672
## HECW1    4.350837 4.279759 4.218375 4.472152 4.408025</code></pre><pre class=r><code>head(ExampleGRF)</code></pre><pre><code>##          x
## 1    ACAD8
## 2   ANAPC2
## 3  ANKRD22
## 4   ANKRD2
## 5 ARHGAP35
## 6    ASH1L</code></pre><p>Please, note that the <strong>individuals are in the columns</strong> and the <strong>gene expressions are in the rows</strong>. Moreover, the <code>row.names()</code> are the names
of the genes. The list of genes that will be used for measuring the
interactions are in <code>ExampleGRF</code>. There should always be more than 2 of
them contained in the expression set. If there are no common nodes to be
measured, the method will return an error.</p><pre class=r><code>sum(ExampleGRF$x %in% row.names(Microarray_Expression1))</code></pre><pre><code>## [1] 168</code></pre><div id=running-the-wto class="section level4"><h4>Running the wTO</h4><p>We can run the <code>wTO</code> package with 3 modes. The first one is running the
wTO without resampling. For that we can use the <code>wTO()</code> . The second
one, <code>wTO.Complete()</code>, gives you the whole diagnosis plot,
hard-threshold on the <em>ω</em><sub><em>i</em>, <em>j</em></sub>, the
<em>ω</em><sub><em>i</em>, <em>j</em></sub>, |<em>ω</em><sub><em>i</em>, <em>j</em></sub>| values and p-values.
The last mode, <code>wTO.fast()</code>, just returns the <em>ω</em><sub><em>i</em>, <em>j</em></sub>
values and p-value.</p><div id=using-the-wto-function class="section level5"><h5>Using the <code>wTO()</code> function:</h5><p>To use the <code>wTO()</code> function, the first step is to compute the
correlation among the nodes of interest using <code>CorrelationOverlap()</code> and
then use it as input for the <code>wTO()</code>. In the first function the user is
allowed to choose the method for correlation between Pearson (‘p’) or
Spearman (‘s’). The second function allows the choice between absolute
values (‘abs’) or signed values (‘sign’). Please, keep in mind that the
result of the <code>wTO()</code> function is a matrix, and it can be easily
converted to an edge list using the function <code>wTO.in.line()</code>.</p><pre class=r><code>wTO_p_abs = CorrelationOverlap(Data = Microarray_Expression1,
                               Overlap = ExampleGRF$x, 
                               method = &#39;p&#39;) %&gt;% 
  wTO(., sign = &#39;abs&#39;)
wTO_p_abs[1:5,1:5]</code></pre><pre><code>##         ZNF333 ZNF28 ANKRD22   ZFR TRIM33
## ZNF333   0.352 0.237   0.269 0.242  0.241
## ZNF28    0.237 0.287   0.209 0.206  0.239
## ANKRD22  0.269 0.209   0.299 0.199  0.252
## ZFR      0.242 0.206   0.199 0.328  0.258
## TRIM33   0.241 0.239   0.252 0.258  0.361</code></pre><pre class=r><code>wTO_p_abs %&lt;&gt;% 
  wTO.in.line()

head(wTO_p_abs)</code></pre><pre><code>##     Node.1  Node.2   wTO
## 1:  ZNF333   ZNF28 0.237
## 2:  ZNF333 ANKRD22 0.269
## 3:   ZNF28 ANKRD22 0.209
## 4:  ZNF333     ZFR 0.242
## 5:   ZNF28     ZFR 0.206
## 6: ANKRD22     ZFR 0.199</code></pre><pre class=r><code>wTO_s_abs = CorrelationOverlap(Data = Microarray_Expression1, 
                               Overlap = ExampleGRF$x, 
                               method = &#39;s&#39;) %&gt;% 
  wTO(., sign = &#39;abs&#39;) %&gt;% 
  wTO.in.line()
head(wTO_s_abs)</code></pre><pre><code>##     Node.1  Node.2   wTO
## 1:  ZNF333   ZNF28 0.236
## 2:  ZNF333 ANKRD22 0.258
## 3:   ZNF28 ANKRD22 0.215
## 4:  ZNF333     ZFR 0.264
## 5:   ZNF28     ZFR 0.187
## 6: ANKRD22     ZFR 0.193</code></pre><pre class=r><code>wTO_p_sign = CorrelationOverlap(Data = Microarray_Expression1, 
                                Overlap = ExampleGRF$x, 
                                method = &#39;p&#39;) %&gt;% 
  wTO(., sign = &#39;sign&#39;) %&gt;%
  wTO.in.line()
head(wTO_p_sign)</code></pre><pre><code>##     Node.1  Node.2    wTO
## 1:  ZNF333   ZNF28 -0.099
## 2:  ZNF333 ANKRD22 -0.185
## 3:   ZNF28 ANKRD22  0.076
## 4:  ZNF333     ZFR -0.117
## 5:   ZNF28     ZFR -0.077
## 6: ANKRD22     ZFR -0.036</code></pre><pre class=r><code>wTO_s_sign = CorrelationOverlap(Data = Microarray_Expression1,
                                Overlap = ExampleGRF$x, 
                                method = &#39;s&#39;) %&gt;%
  wTO(., sign = &#39;sign&#39;) %&gt;% 
  wTO.in.line()
head(wTO_s_sign)</code></pre><pre><code>##     Node.1  Node.2    wTO
## 1:  ZNF333   ZNF28 -0.064
## 2:  ZNF333 ANKRD22 -0.143
## 3:   ZNF28 ANKRD22  0.029
## 4:  ZNF333     ZFR -0.164
## 5:   ZNF28     ZFR -0.011
## 6: ANKRD22     ZFR  0.024</code></pre></div><div id=using-the-wto.complete-function class="section level5"><h5>Using the <code>wTO.Complete()</code> function:</h5><p>The usage of the function <code>wTO.Complete()</code> is straight-forward. No
plug-in-functions() are necessary. The arguments parsed to the
<code>wTO.Complete()</code> functions are the number <em>k</em> of threads that should be
used for computing the <em>ω</em><sub><em>i</em>,<em>j</em></sub>, the amount of
replications, <em>n</em>, the expression matrix, <em>Data</em>, the <em>Overlapping</em>
nodes, the correlation <em>method</em> (<strong>Pearson</strong> or <strong>Spearman</strong>) for the
<em>method_resampling</em> that should be <strong>Bootstrap</strong>, <strong>BlockBootstrap</strong> or
<strong>Reshuffle</strong>, the p-value correction method, <em>pvalmethod</em> (any from the
p.adjust.methods), if the correlation should be saved, the <em>δ</em> is the
expected difference, <em>expected.diff</em>, between the resampled values and
the <em>ω</em><sub><em>i</em>, <em>j</em></sub> and also if the diagnosis <em>plot</em> should be
plotted.</p><pre class=r><code>wTO_s_sign_complete = wTO.Complete(k = 5, 
                                   n = 250,
                                   Data = Microarray_Expression1, 
                                   Overlap = ExampleGRF$x, 
                                   method = &#39;p&#39;, 
                                   method_resampling = &#39;Bootstrap&#39;,
                                   pvalmethod = &#39;BH&#39;, 
                                   savecor = TRUE, 
                                   expected.diff = 0.2, 
                                   plot = TRUE)</code></pre><pre><code>## There are 168 overlapping nodes, 268 total nodes and 18 individuals.</code></pre><pre><code>## This function might take a long time to run. Don&#39;t turn off the computer.</code></pre><pre><code>## Simulations are done.</code></pre><pre><code>## Computing p-values</code></pre><pre><code>## Computing cutoffs</code></pre><pre><code>## Done!</code></pre><p><img src=/rpackages/wto/index_files/figure-html/unnamed-chunk-6-1.png width=672></p><p>The diagnosis plot shows the quality of the resampling (first two
plots). The closer the purple line to the black line, the better. The
<em>ω</em><sub><em>i</em>,<em>j</em></sub> vs |<em>ω</em><sub><em>i</em>,<em>j</em></sub>| shows the amount of
<em>ω</em><sub><em>i</em>, <em>j</em></sub> being affected by cancellations on the heuristics
of the method, the more similar to a <strong>smile plot</strong>, the better. The
last two plots show the relashionship between p-values and the
<em>ω</em><sub><em>i</em>,<em>j</em></sub>. It is expected that higher <em>ω</em>’s presents lower
p-values.</p><p>The resulting object from the <code>wTO.Complete()</code> function is a list
containing:
* wTO an edge list of informations such as the signed and
unsigned <em>ω</em><sub><em>i</em>,<em>j</em></sub> values its raw and adjusted p-values.
* Correlation values, also as an edge list
* Quantiles, the quantiles from the empirical distribution and the calculated <em>ω</em>’s from the
original data, for both signed and unsigned networks.</p><pre class=r><code>wTO_s_sign_complete</code></pre><pre><code>## $wTO
##        Node.1  Node.2 wTO_sign wTO_abs pval_sig pval_abs  Padj_sig   Padj_abs
##     1: ZNF333   ZNF28   -0.099   0.237    0.152    0.012 0.3472353 0.02018417
##     2: ZNF333 ANKRD22   -0.185   0.269    0.184    0.004 0.3472353 0.01092311
##     3: ZNF333     ZFR   -0.117   0.242    0.116    0.016 0.3472353 0.02361368
##     4: ZNF333  TRIM33    0.007   0.241    0.136    0.008 0.3472353 0.01629268
##     5: ZNF333   RIMS3   -0.325   0.409    0.140    0.000 0.3472353 0.00000000
##    ---                                                                       
## 14024: ANAPC2   SBNO2   -0.147   0.298    0.160    0.000 0.3472353 0.00000000
## 14025: ANAPC2  ZNF528   -0.142   0.222    0.164    0.004 0.3472353 0.01092311
## 14026:  TIGD7   SBNO2   -0.297   0.354    0.104    0.000 0.3472353 0.00000000
## 14027:  TIGD7  ZNF528   -0.099   0.219    0.152    0.020 0.3472353 0.02684014
## 14028:  SBNO2  ZNF528    0.141   0.311    0.272    0.008 0.3554039 0.01629268
## 
## $Correlation
##          Node.1   Node.2          Cor
##     1:  FAM122B DEFB108B  0.366857931
##     2:  FAM122B   CCSER2  0.278870911
##     3: DEFB108B   CCSER2 -0.252482453
##     4:  FAM122B     GPD2 -0.005649124
##     5: DEFB108B     GPD2 -0.107064848
##    ---                               
## 35774:   TRIM23   ZNF528  0.054249174
## 35775:   ZNF559   ZNF528 -0.218309729
## 35776:   ANAPC2   ZNF528 -0.013821370
## 35777:    TIGD7   ZNF528  0.011807143
## 35778:    SBNO2   ZNF528  0.092317502
## 
## $Quantiles
##                         0.1%  2.5%   10%  90% 97.5% 99.9%
## Empirical.Quantile     -0.56 -0.46 -0.34 0.37  0.49  0.56
## Quantile               -0.50 -0.40 -0.28 0.32  0.43  0.52
## Empirical.Quantile.abs  0.21  0.24  0.27 0.47  0.52  0.56
## Quantile.abs            0.18  0.19  0.21 0.41  0.47  0.53
## 
## attr(,&quot;class&quot;)
## [1] &quot;wTO&quot;  &quot;list&quot;</code></pre></div><div id=using-the-wto.fast-function class="section level5"><h5>Using the <code>wTO.fast()</code> function:</h5><p>The <code>wTO.fast()</code> function is a simplified verion of the <code>wTO.Complete()</code>
function, that doesn’t return diagnosis, correlation, nor the quantiles,
but allows the user to choose the method for correlation, the sign of
the <em>ω</em> to be calculated and the resampling method should be one of the
two <strong>Bootrastap</strong> or <strong>BlockBootstrap</strong>. The p-values are the raw
p-values and if the user desires to calculate its correction it can be
easily done as shown above.</p><pre class=r><code>fast_example = wTO.fast(Data = Microarray_Expression1, 
                        Overlap = ExampleGRF$x, 
                        method = &#39;s&#39;, 
                        sign = &#39;sign&#39;, 
                        delta = 0.2,
                        n = 250, 
                        method_resampling = &#39;Bootstrap&#39;)</code></pre><pre><code>## There are 168 overlapping nodes, 268 total nodes and 18 individuals.</code></pre><pre><code>## This function might take a long time to run. Don&#39;t turn off the computer.</code></pre><pre><code>##  1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99  100  101  102  103  104  105  106  107  108  109  110  111  112  113  114  115  116  117  118  119  120  121  122  123  124  125  126  127  128  129  130  131  132  133  134  135  136  137  138  139  140  141  142  143  144  145  146  147  148  149  150  151  152  153  154  155  156  157  158  159  160  161  162  163  164  165  166  167  168  169  170  171  172  173  174  175  176  177  178  179  180  181  182  183  184  185  186  187  188  189  190  191  192  193  194  195  196  197  198  199  200  201  202  203  204  205  206  207  208  209  210  211  212  213  214  215  216  217  218  219  220  221  222  223  224  225  226  227  228  229  230  231  232  233  234  235  236  237  238  239  240  241  242  243  244  245  246  247  248  249  250 Done!</code></pre><pre class=r><code>head(fast_example)</code></pre><pre><code>##     Node.1  Node.2    wTO  pval  pval.adj
## 1:  ZNF333   ZNF28 -0.064 0.272 0.4363894
## 2:  ZNF333 ANKRD22 -0.143 0.308 0.4363894
## 3:   ZNF28 ANKRD22  0.029 0.224 0.4363894
## 4:  ZNF333     ZFR -0.164 0.200 0.4363894
## 5:   ZNF28     ZFR -0.011 0.336 0.4363894
## 6: ANKRD22     ZFR  0.024 0.284 0.4363894</code></pre><pre class=r><code>fast_example$adj.pval = p.adjust(fast_example$pval)</code></pre></div></div></div><div id=metagenomic-data class="section level3"><h3>Metagenomic data</h3><p>Along with the expression data, the <code>wTO</code> package also includes a
metagenomics dataset that is the abundance of some OTU’s in bacterias
collected since 1997. More about this data can be found at
<span class="math display">\[&lt;https://www.ebi.ac.uk/metagenomics/projects/ERP013549>\]</span>.</p><p>The OTU (Operational Taxonomic Units) contains the taxonomy of the
particular OTU and from Week1 to Week98, the abundance of that
particular OTU in that week.</p><pre class=r><code>data(&quot;metagenomics_abundance&quot;)
metagenomics_abundance[2:10, 1:10]</code></pre><pre><code>##                                                                                                            OTU
## 2                            Root;k__Archaea;p__Euryarchaeota;c__Thermoplasmata;o__E2;f__MarinegroupII;g__;s__
## 3                   Root;k__Bacteria;p__Actinobacteria;c__Acidimicrobiia;o__Acidimicrobiales;f__OCS155;g__;s__
## 4         Root;k__Bacteria;p__Actinobacteria;c__Actinobacteria;o__Actinomycetales;f__Microbacteriaceae;g__;s__
## 5                  Root;k__Bacteria;p__Bacteroidetes;c__Cytophagia;o__Cytophagales;f__Flammeovirgaceae;g__;s__
## 6            Root;k__Bacteria;p__Bacteroidetes;c__Cytophagia;o__Cytophagales;f__Flammeovirgaceae;g__JTB248;s__
## 7                          Root;k__Bacteria;p__Bacteroidetes;c__Flavobacteriia;o__Flavobacteriales;f__;g__;s__
## 8            Root;k__Bacteria;p__Bacteroidetes;c__Flavobacteriia;o__Flavobacteriales;f__Cryomorphaceae;g__;s__
## 9  Root;k__Bacteria;p__Bacteroidetes;c__Flavobacteriia;o__Flavobacteriales;f__Cryomorphaceae;g__Fluviicola;s__
## 10        Root;k__Bacteria;p__Bacteroidetes;c__Flavobacteriia;o__Flavobacteriales;f__Flavobacteriaceae;g__;s__
##    Week1 Week2 Week3 Week4 Week5 Week6 Week7 Week8 Week9
## 2      1     6     0     0     0     1     0     1     0
## 3      0     0     0     0     0     0     0     5     0
## 4      0     0     0     0     0     0     0     0     0
## 5      0     1     0     0     0     0     0     0     0
## 6      0     0     0     0     0     0     0     0     0
## 7      0     1     0     0     0     0     0     1     0
## 8      0     0     0     0     0     0     0     1     0
## 9      0     0     0     0     0     0     0     1     0
## 10     0     1     0     0     0     0     0     7     0</code></pre><p>Before we are able to define the network, we have first to understand
the patterns of autocorrelation of each species, and then define the
lag, that will be used for the <strong>BlockBootstrap</strong> resampling in the
<code>wTO.Complete()</code> or <code>fast.wTO()</code> functions. To define the lag, we use
autocorrelation function <code>acf()</code>.</p><pre class=r><code>row.names(metagenomics_abundance) = metagenomics_abundance$OTU
metagenomics_abundance = metagenomics_abundance[,-1]
par(mfrow = c(3,3))
for ( i in 1:nrow(metagenomics_abundance)){
  acf(t(metagenomics_abundance[i,]))
}</code></pre><p><img src=/rpackages/wto/index_files/figure-html/unnamed-chunk-10-1.png width=672><img src=/rpackages/wto/index_files/figure-html/unnamed-chunk-10-2.png width=672><img src=/rpackages/wto/index_files/figure-html/unnamed-chunk-10-3.png width=672><img src=/rpackages/wto/index_files/figure-html/unnamed-chunk-10-4.png width=672><img src=/rpackages/wto/index_files/figure-html/unnamed-chunk-10-5.png width=672><img src=/rpackages/wto/index_files/figure-html/unnamed-chunk-10-6.png width=672><img src=/rpackages/wto/index_files/figure-html/unnamed-chunk-10-7.png width=672><img src=/rpackages/wto/index_files/figure-html/unnamed-chunk-10-8.png width=672></p><p>Because most of them have only a high autocorrelation with itself or
maximum 2 weeks, we will use a lag of 2 for the blocks used in the
bootstrap.</p><p>The functions <code>wTO.fast()</code> and <code>wTO.Complete()</code> are able to accomodate
the lag parameter, therefore, they will be used here.</p><pre class=r><code>Meta_fast = wTO.fast(Data = metagenomics_abundance, 
                     Overlap = row.names(metagenomics_abundance), 
                     method = &#39;p&#39;, 
                     sign = &#39;sign&#39;, 
                     n = 250, 
                     method_resampling = &#39;BlockBootstrap&#39;, 
                     lag = 2)</code></pre><pre><code>## There are 67 overlapping nodes, 67 total nodes and 98 individuals.</code></pre><pre><code>## This function might take a long time to run. Don&#39;t turn off the computer.</code></pre><pre><code>##  1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99  100  101  102  103  104  105  106  107  108  109  110  111  112  113  114  115  116  117  118  119  120  121  122  123  124  125  126  127  128  129  130  131  132  133  134  135  136  137  138  139  140  141  142  143  144  145  146  147  148  149  150  151  152  153  154  155  156  157  158  159  160  161  162  163  164  165  166  167  168  169  170  171  172  173  174  175  176  177  178  179  180  181  182  183  184  185  186  187  188  189  190  191  192  193  194  195  196  197  198  199  200  201  202  203  204  205  206  207  208  209  210  211  212  213  214  215  216  217  218  219  220  221  222  223  224  225  226  227  228  229  230  231  232  233  234  235  236  237  238  239  240  241  242  243  244  245  246  247  248  249  250 Done!</code></pre><pre class=r><code>Meta_Complete = wTO.Complete(k = 1, 
                             n = 250, 
                             Data = metagenomics_abundance, 
                             Overlap = row.names(metagenomics_abundance),
                             method = &#39;s&#39; , 
                             method_resampling = &#39;BlockBootstrap&#39;, 
                             lag = 2 )</code></pre><pre><code>## There are 67 overlapping nodes, 67 total nodes and 98 individuals.
## This function might take a long time to run. Don&#39;t turn off the computer.
## Simulations are done.
## Computing p-values
## Computing cutoffs
## Done!</code></pre><p><img src=/rpackages/wto/index_files/figure-html/unnamed-chunk-11-1.png width=672></p></div></div><div id=consensus-network class="section level2"><h2>Consensus Network</h2><p>From the expression data-sets, we are able to draw a Consensus Network.
For that, the function <code>wTO.Consensus()</code> can be used. This function
works in a special way, that the user should pass a list of data.frames
containing the Nodes names and the wTO and p-values. We show an example
above.</p><p>Let’s calculate the networks the same way we did in the Section <a href=#genomic-data>Genomic
data</a>.</p><pre class=r><code>wTO_Data1 = wTO.fast(Data = Microarray_Expression1, 
                     Overlap = ExampleGRF$x, 
                     method = &#39;p&#39;, 
                     n = 250)</code></pre><pre><code>## There are 168 overlapping nodes, 268 total nodes and 18 individuals.</code></pre><pre><code>## This function might take a long time to run. Don&#39;t turn off the computer.</code></pre><pre><code>##  1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99  100  101  102  103  104  105  106  107  108  109  110  111  112  113  114  115  116  117  118  119  120  121  122  123  124  125  126  127  128  129  130  131  132  133  134  135  136  137  138  139  140  141  142  143  144  145  146  147  148  149  150  151  152  153  154  155  156  157  158  159  160  161  162  163  164  165  166  167  168  169  170  171  172  173  174  175  176  177  178  179  180  181  182  183  184  185  186  187  188  189  190  191  192  193  194  195  196  197  198  199  200  201  202  203  204  205  206  207  208  209  210  211  212  213  214  215  216  217  218  219  220  221  222  223  224  225  226  227  228  229  230  231  232  233  234  235  236  237  238  239  240  241  242  243  244  245  246  247  248  249  250 Done!</code></pre><pre class=r><code>wTO_Data2 = wTO.fast(Data = Microarray_Expression2, 
                     Overlap = ExampleGRF$x, 
                     method = &#39;p&#39;, 
                     n = 250)</code></pre><pre><code>## There are 168 overlapping nodes, 268 total nodes and 18 individuals.
## This function might take a long time to run. Don&#39;t turn off the computer.
##  1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99  100  101  102  103  104  105  106  107  108  109  110  111  112  113  114  115  116  117  118  119  120  121  122  123  124  125  126  127  128  129  130  131  132  133  134  135  136  137  138  139  140  141  142  143  144  145  146  147  148  149  150  151  152  153  154  155  156  157  158  159  160  161  162  163  164  165  166  167  168  169  170  171  172  173  174  175  176  177  178  179  180  181  182  183  184  185  186  187  188  189  190  191  192  193  194  195  196  197  198  199  200  201  202  203  204  205  206  207  208  209  210  211  212  213  214  215  216  217  218  219  220  221  222  223  224  225  226  227  228  229  230  231  232  233  234  235  236  237  238  239  240  241  242  243  244  245  246  247  248  249  250 Done!</code></pre><p>Now, let’s combine both networks in one Consensus Network.</p><pre class=r><code>CN_expression = wTO.Consensus(data = list (wTO_Data1 = data.frame
                                           (Node.1 = wTO_Data1$Node.1, 
                                             Node.2 = wTO_Data1$Node.2, 
                                             wTO = wTO_Data1$wTO,
                                             pval = wTO_Data1$pval)
                                           , wTO_Data2C = data.frame
                                           (Node.1 = wTO_Data2$Node.1, 
                                             Node.2 = wTO_Data2$Node.2, 
                                             wTO = wTO_Data2$wTO,
                                             pval = wTO_Data2$pval)))</code></pre><pre><code>## Joining by: Node.1, Node.2
## Joining by: Node.1, Node.2</code></pre><pre><code>## Joining by: ID</code></pre><pre><code>## Total common nodes: 168</code></pre><p>Or using the <code>wTO.Complete()</code>:</p><pre class=r><code>wTO_Data1C = wTO.Complete(Data = Microarray_Expression1, 
                          Overlap = ExampleGRF$x, 
                          method = &#39;p&#39;, 
                          n = 250, 
                          k = 5)</code></pre><pre><code>## There are 168 overlapping nodes, 268 total nodes and 18 individuals.</code></pre><pre><code>## This function might take a long time to run. Don&#39;t turn off the computer.</code></pre><pre><code>## Simulations are done.</code></pre><pre><code>## Computing p-values</code></pre><pre><code>## Computing cutoffs</code></pre><pre><code>## Done!</code></pre><pre class=r><code>wTO_Data2C = wTO.Complete(Data = Microarray_Expression2, 
                          Overlap = ExampleGRF$x, 
                          method = &#39;p&#39;, 
                          n = 250, 
                          k = 5)</code></pre><pre><code>## There are 168 overlapping nodes, 268 total nodes and 18 individuals.</code></pre><pre><code>## This function might take a long time to run. Don&#39;t turn off the computer.</code></pre><pre><code>## Simulations are done.</code></pre><pre><code>## Computing p-values</code></pre><pre><code>## Computing cutoffs</code></pre><p><img src=/rpackages/wto/index_files/figure-html/unnamed-chunk-14-1.png width=672></p><pre><code>## Done!</code></pre><p><img src=/rpackages/wto/index_files/figure-html/unnamed-chunk-14-2.png width=672></p><p>Now, let’s combine both networks in one Consensus Network.</p><pre class=r><code>CN_expression = wTO.Consensus(data = list (wTO_Data1C = data.frame
                                           (Node.1 = wTO_Data1C$wTO$Node.1, 
                                             Node.2 = wTO_Data1C$wTO$Node.2, 
                                             wTO = wTO_Data1C$wTO$wTO_sign,
                                             pval = wTO_Data1C$wTO$pval_sig), wTO_Data2C = data.frame
                                           (Node.1 = wTO_Data2C$wTO$Node.1, 
                                             Node.2 = wTO_Data2C$wTO$Node.2, 
                                             wTO = wTO_Data2C$wTO$wTO_sign,
                                             pval = wTO_Data2C$wTO$pval_sig)))</code></pre><pre><code>## Joining by: Node.1, Node.2
## Joining by: Node.1, Node.2</code></pre><pre><code>## Joining by: ID</code></pre><pre><code>## Total common nodes: 168</code></pre><pre class=r><code>head(CN_expression)</code></pre><pre><code>##   Node.1  Node.2         CN pval.fisher
## 1 ZNF333   ZNF28 -0.1191288  0.08584314
## 2 ZNF333 ANKRD22 -0.1400000  0.11936952
## 3 ZNF333     ZFR -0.1091659  0.09698604
## 4 ZNF333  TRIM33 -0.0240000  0.06464921
## 5 ZNF333   RIMS3 -0.2798101  0.09711171
## 6 ZNF333  ZNF595  0.1542850  0.12426164</code></pre></div><div id=visualization class="section level2"><h2>Visualization</h2><p>The <code>wTO</code> package also includes an interactive visualization tool that
can be used to inspect the results of the wTO netwoks or Consensus
Network.</p><p>The arguments given to this function are the Nodes names, its wTO and
p-values. Optionals are the cutoffs that can be applied to the p-value
or to the wTO value. We highly reccomend using both by subseting the
data previous to the visualization. The layout of the network can be
also chosen from a variety that are implemented in igraph package, for
the the Make_Cluster argument many clustering algorithms that are
implemented in igraph can be used. The final graph can be exported as an
<code>html</code> or as <code>png</code>.</p><pre class=r><code>Visualization = NetVis(Node.1 = CN_expression$Node.1, 
                       Node.2 = CN_expression$Node.2,
                       wTO = CN_expression$CN, 
                       pval = CN_expression$pval.fisher, 
                       cutoff = list(kind = &#39;pval&#39;, value = 0.001),
                       MakeGroups = &#39;louvain&#39;, 
                       layout = &#39;layout_components&#39;)</code></pre><pre><code>## Joining by: id</code></pre><pre class=r><code>CN_expression_filtered = subset(CN_expression, 
                                abs(CN_expression$CN)&gt; 0.4 &amp;
                                  CN_expression$pval.fisher &lt; 0.0001)

dim(CN_expression_filtered)</code></pre><pre><code>## [1] 50  4</code></pre><pre class=r><code>Visualization2 = NetVis(
  Node.1 = CN_expression_filtered$Node.1, 
  Node.2 = CN_expression_filtered$Node.2,
  wTO = CN_expression_filtered$CN, 
  pval = CN_expression_filtered$pval.fisher, 
  cutoff = list(kind = &#39;pval&#39;, value = 0.001), 
  MakeGroups = &#39;louvain&#39;, 
  layout = &#39;layout_components&#39;, path = &#39;Vis.html&#39;)</code></pre><pre><code>## Joining by: id</code></pre><pre><code>## Vis.html</code></pre></div><div id=session-info class="section level2"><h2>Session Info</h2><pre class=r><code>sessionInfo()</code></pre><pre><code>## R version 4.1.0 (2021-05-18)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] magrittr_2.0.1 wTO_1.6.3     
## 
## loaded via a namespace (and not attached):
##  [1] igraph_1.2.6      Rcpp_1.0.6        knitr_1.33        som_0.3-5.1      
##  [5] R6_2.5.0          rlang_0.4.11      highr_0.9         stringr_1.4.0    
##  [9] plyr_1.8.6        visNetwork_2.0.9  tools_4.1.0       parallel_4.1.0   
## [13] data.table_1.14.0 xfun_0.23         jquerylib_0.1.4   htmltools_0.5.1.1
## [17] yaml_2.2.1        digest_0.6.27     bookdown_0.22     reshape2_1.4.4   
## [21] htmlwidgets_1.5.3 sass_0.4.0        evaluate_0.14     rmarkdown_2.8.5  
## [25] blogdown_1.3      stringi_1.6.2     compiler_4.1.0    bslib_0.2.5.1    
## [29] jsonlite_1.7.2    pkgconfig_2.0.3</code></pre></div><details closed class="f6 fw7 input-reset"><dl class="f6 lh-copy"><dt class=fw7>Posted on:</dt><dd class="fw5 ml0">November 17, 2018</dd></dl><dl class="f6 lh-copy"><dt class=fw7>Length:</dt><dd class="fw5 ml0">18 minute read, 3778 words</dd></dl><dl class="f6 lh-copy"><dt class=fw7>Categories:</dt><dd class="fw5 ml0"><a href=/categories/r-packages>r packages</a> <a href=/categories/co-expression>co-expression</a> <a href=/categories/networks>networks</a></dd></dl><dl class="f6 lh-copy"><dt class=fw7>See Also:</dt></dl></details></section><footer class=post-footer><div class="post-pagination dt w-100 mt4 mb2"><a class="next dtc pl2 tr v-top fw6" href=/rpackages/richr/>RichR &rarr;</a></div></footer></article></section></main><footer class="site-footer pv4 bt b--transparent ph5" role=contentinfo><nav class="db dt-l w-100"><p class="site-copyright f7 db dtc-l v-mid w-100 w-33-l tc tl-l pv2 pv0-l mv0 lh-copy">&copy; 2021 Deisy Morselli Gysi
<span class=middot-divider></span>Made with <span xmlns:dct=http://purl.org/dc/terms/ property="dct:title"><a xmlns:dct=http://purl.org/dc/terms/ href=https://github.com/hugo-apero/ rel=dct:source>Hugo Apéro</a></span>.<br>Based on <span xmlns:dct=http://purl.org/dc/terms/ property="dct:title"><a xmlns:dct=http://purl.org/dc/terms/ href=https://github.com/formspree/blogophonic-hugo rel=dct:source>Blogophonic</a></span> by <a xmlns:cc=http://creativecommons.org/ns# href=https://formspree.io property="cc:attributionName" rel=cc:attributionurl>Formspree</a>.</p><div class="site-social-links db dtc-l v-mid w-100 w-33-l tc pv2 pv0-l mv0"><div class=social-icon-links aria-hidden=true><a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href=https://github.com/deisygysi title=github target=_blank rel=noopener><i class="fab fa-github fa-lg fa-fw"></i></a><a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href=https://twitter.com/GysiDeisy title=twitter target=_blank rel=noopener><i class="fab fa-twitter fa-lg fa-fw"></i></a><a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href=https://www.linkedin.com/in/deisy-morselli-gysi/ title=linkedin target=_blank rel=noopener><i class="fab fa-linkedin fa-lg fa-fw"></i></a><a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://scholar.google.com/citations?user=LUOTahsAAAAJ&hl=en" title=google-scholar target=_blank rel=noopener><i class="ai ai-google-scholar fa-lg fa-fw"></i></a><a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href=http://lattes.cnpq.br/8705355235534573 title=lattes target=_blank rel=noopener><i class="ai ai-lattes fa-lg fa-fw"></i></a><a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href=https://www.researchgate.net/profile/Deisy-Gysi title=researchgate target=_blank rel=noopener><i class="ai ai-researchgate fa-lg fa-fw"></i></a></div></div><div class="site-links f6 db dtc-l v-mid w-100 w-67-l tc tr-l pv2 pv0-l mv0"><a class="dib pv1 ph2 link" href=/license/ title=License>License</a>
<a class="dib pv1 ph2 link" href=/contact/ title="Contact form">Contact</a></div></nav></footer></div></body></html>